# 任务  
帮我写微信小游戏代码，小游戏主要玩法是允许用户画一条鱼然后将其放入鱼缸。

# 要求  
1. 代码简洁、可靠、健壮，添加必要的打印监控代码状态，并且保证代码可运行。  
2. 用game.js和game.json实现。  
3. 逐个给出每个程序脚本，不要缺失任何文件，保证项目可运行。   
4. 每个button规格统一为长80像素高40像素，除非要求特殊处理。     
5. 利用代码内置风格统一美化所有组件。  

# 小游戏UI和Button设计    
首先游戏界面整体背景为白色，以手机屏幕竖直状态运行，顶部空出80个像素高度用来避开手机的通知栏。
## 首页部分的整体UI由上到下是功能区、指示区、绘画区、得分区、跳转区。
1. 功能区包含3个part，每个part高度60像素，纵向排列。part1 从左到右依次是7个圆圈按键（直径大小30像素，外框黑色描边，内部颜色分别是黑色、红色、绿色、紫色、黄色、橘色、白色，支持用户选择不同颜色绘画），水平居中均匀分开。part2 左边首先显示文本"Size："，然后是一个滑动控件，用来调节橡皮擦和画笔的粗细。part3 从左到右首先是Eraser的button（橡皮擦）支持用户擦除某区域，然后是Undo的button支持用户一笔笔撤销刚刚的绘画笔迹，再然后是Clear的button支持用户直接清空绘画区域，最后是Flip的button支持用户将绘画左右翻转。四个按键水平居中均匀分开。
2. 指示区占80个像素高度，只包含有两行文本，第一行是 "画一条鱼吧!"，第二行是"鱼头请朝右"， 两行文本字体一致，文本高度均为35像素，布局水平居中。
3. 绘画区由矩形构成，允许用户在矩形内作画，矩形区域高220像素，宽度距离屏幕两边各10像素。
4. 得分区占50个像素高，中间有一行文本"AI评分：0"，文本高度占30像素。
5. 跳转区占60个像素高，从左到右有首先是"鱼缸"的button；然后是"让它游起来！" 的button；最后是"排行榜"的button，这三个button水平居中均匀分开，功能暂时不去实现。





这是我的小游戏代码，请你帮我继续优化下。首先保持原代码主体不变，然后代码风格延续简洁、可靠、健壮、有打印核心步骤信息，最后返回优化后的完整代码。
帮我实现，当用户画完一笔后，将画布的绘画借助canvas.toDataURL()获取base64数据，然后调用大模型api获得ai判断的得分，然后将得分在“AI评分”文本这里打印出来。注意在调用大模型api打分的时候要异步执行，不要耽误用户后续绘画。大模型api的使用demo如下






这是我的小游戏代码，请你帮我继续优化下。首先保持原代码主体不变，然后代码风格延续简洁、可靠、健壮，最后返回优化后的完整代码。
能美化下我现在代码里的所有组件吗，让ui看起来更高级




这是我的小游戏代码，请你帮我继续优化下。首先保持原代码主体不变，然后代码风格延续简洁、可靠、健壮，最后返回优化后的完整代码。
能将这个代码逻辑分为几个脚本吗，重新整理下项目结构，让主程序变得更轻盈，各个功能能在主脚本里实现插拔式的解耦模式。给我拆解后的目录和对应代码。不要拆解成太多，根据主要功能拆解成3、4个脚本就行









canvasToTempFilePath
canvasGetImageData


我在开发一款小游戏，核心玩法是允许用户画一条鱼，然后通过代码生成模拟鱼游动的渲染动画，最后放入鱼缸。
附件是我小游戏代码涉及的所有脚本，请你帮我继续优化下，保持原代码主体不变，代码风格延续简洁、可靠、健壮，最后返回优化后的完整代码。
用户点击“让它游起来”的button实现下面的逻辑，首先判断大模型api返回的得分是否大于60分，如果不满足条件弹出提示“AI评分小于60，这鱼画的太抽象”，如果满足条件计算用户绘制的鱼最小外接矩形，根据这个矩形将用户绘制的作品裁剪出来成为子图，然后将子图的长边对齐到50像素，同时宽边等比例缩放，缩放之后我们称新的图为“缩放图”，获得缩放图之后跳转到新的界面，新的界面我们称之为“公共鱼缸”，尺寸与手机屏幕尺寸对齐，背景为水蓝色，然后再公共鱼缸界面参考下面“游动demo”逻辑，将这个逻辑应用到缩放图上，渲染用户绘画的鱼在公共鱼缸里游动的画面，设置返回键，点击返回键返回到上一级界面。游动demo：// 微信小游戏版鱼游动效果



附件是我小游戏代码涉及的所有脚本，请你帮我继续优化或增加新需求，保持原代码主体不变，代码风格延续简洁、可靠、健壮，最后返回本次修改涉及的脚本的完整代码。
在名字为“🚀 让它游起来！”的button对应的现有事件后面增加新事件，新事件为弹出新界面，新界面背景整体为水蓝色














在依赖loadAndShowDatabaseFishes显示所有鱼时候，不是要随机渲染20条鱼嘛，这个逻辑保持不变，但是除此之外必须通过鱼名字指定在数据库里加载出本次绘制的鱼，所以一共是20+1条，其中这1条是本次绘制的鱼，所有21条鱼都是从数据库里读取出来然后渲染的，逻辑统一，删除手动添加鱼的代码



你应该这样，
首先“鱼缸”button的逻辑是完全独立的，和"让它游起来"button没有任何关系。
然后只有开始游戏后第一次点击“鱼缸”的时候在数据库随机选20条鱼渲染，后面再次点击“鱼缸”就不去数据库拉去了，还是渲染最初那次选取的20条鱼，然后设置一个刷新button，只有点击刷新button的时候才清空鱼缸，然后重新随机选20条鱼渲染。


帮我优化“鱼缸”和“让它游起来”两个button的逻辑。
首先请建立一个全局的变量来维护当前鱼缸里存在的所有鱼，然后当游戏开始后用户可能会首先点击“鱼缸”，这个时候就随机在数据库里随机选取









附件是我小游戏代码涉及的所有脚本，请你帮我继续优化或增加新需求，保持原代码主体不变，代码风格延续简洁、可靠、健壮，最后返回本次修改涉及的脚本的完整代码。
我发现代码里有些函数重复定义，还有些函数冗余，代码结构设计也不合理。请你帮我优化所有的附件脚本解决这些问题。但是注意保证原代码实现的功能逻辑不变并且简洁，然后给我所有脚本的完整代码。简洁！功能逻辑不变。








附件是我小游戏代码涉及的所有脚本，请你帮我分析代码里面有没有函数重复定义，有没有逻辑冗余，程序功能重复，有没有功能类似的函数能够合并。你先回答我有没有，然后我们在讨论怎么改。

请你帮我优化以上问题，目标是使代码变得简洁高效，最大限度减少代码行数，但是要保证代码实现的功能不变和健壮性不变。1. 错误处理简化







